<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="/api/v1/images/favicon.png">
    <title>Admin Panel - TripGo</title>
    <link
            href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
            rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap");

        * {
          font-family: "Inter", sans-serif;
        }

        .gradient-bg {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .card-hover {
          transition: none;
        }

        .card-hover:hover {
          box-shadow: none;
        }

        .modal-enter {
          animation: modalEnter 0.3s ease-out;
        }

        @keyframes modalEnter {
          from {
            opacity: 0;
            transform: scale(0.95);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }

        .btn-primary {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          transition: none;
        }

        .btn-primary:hover {
          transform: none;
          box-shadow: none;
        }

        .stat-card {
          background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
        }

        .table-row {
          transition: none;
        }

        .table-row:hover {
          background-color: #f8f9ff;
          transform: none;
        }

        .badge {
          padding: 4px 12px;
          border-radius: 12px;
          font-size: 12px;
          font-weight: 600;
        }

        .input-modern {
          border: 2px solid #e5e7eb;
          transition: all 0.3s ease;
        }

        .input-modern:focus {
          border-color: #667eea;
          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
          outline: none;
        }
    </style>
</head>
<body class="bg-gray-50">
<!-- Sidebar -->
<div class="flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <aside class="w-64 gradient-bg text-white hidden md:block">
        <div class="p-6">
            <div class="flex items-center space-x-3 ">
                <a href="/api/v1" class="flex items-center space-x-3 mb-8 w-[200px]">
                    <img src="/api/v1/images/logo.png" >
                </a>
            </div>

            <nav class="space-y-2">
                <a
                        href="/api/v1/admin1"
                        class="flex items-center space-x-3 hover:bg-white hover:bg-opacity-10 rounded-lg p-3 backdrop-blur-sm"
                >
                    <span class="text-xl">üìä</span>
                    <span class="font-medium">Dashboard</span>
                </a>
                <a
                        href="/api/v1/bus"
                        class="flex items-center space-x-3 bg-white bg-opacity-20 rounded-lg p-3 transition"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 160 160" fill="none">
                        <path d="M79.9946 140C113.132 140 139.995 113.137 139.995 80C139.995 46.8629 113.132 20 79.9946 20C46.8575 20 19.9946 46.8629 19.9946 80C19.9946 113.137 46.8575 140 79.9946 140Z" fill="#FFE2CD"/>
                        <path d="M73.9846 129.14C78.1946 130.38 82.7246 130.19 86.9146 128.89L137.735 113.17C140.655 112.31 142.645 109.72 142.645 106.78V74.73C142.645 72.74 141.725 70.85 140.135 69.58L100.465 37.29C94.3346 32.4 77.9646 25.97 77.2946 33.6L65.4446 121.03C65.2046 123.78 68.0646 127.39 73.9746 129.14H73.9846Z" fill="white"/>
                        <path d="M74.9947 129.67L24.6547 124.49C20.1847 124.03 18.1547 120.76 17.5247 114.62V114.67C14.8147 74.25 23.4847 46.81 23.4847 46.81C24.5647 43.26 27.8847 40.73 31.3847 40.13L32.4947 39.95C45.8947 37.25 80.1047 30.13 80.1047 30.13C85.0347 29.28 89.5647 33.01 89.5647 37.93L83.8947 121.8C83.8947 126.5 79.7547 130.17 74.9947 129.68V129.67Z" fill="#C22126"/>
                        <path d="M76.4847 87.28L26.6148 87.19C22.4348 86.76 19.4147 83.05 19.9147 78.94L20.9648 71.22C22.0148 63.46 23.4748 55.75 25.3448 48.13L25.4048 47.87C26.3348 44.59 28.7147 42.4 31.9847 41.83L78.5147 32.25C83.1247 31.45 87.3547 34.94 87.3547 39.54L84.7947 79.9C84.7947 84.29 80.9248 87.72 76.4748 87.26L76.4847 87.28Z" fill="#551615"/>
                        <path d="M76.1926 110.556C76.4275 106.913 73.9596 103.788 70.6803 103.577C67.401 103.365 64.5522 106.147 64.3173 109.79C64.0823 113.433 66.5502 116.558 69.8295 116.769C73.1088 116.981 75.9576 114.199 76.1926 110.556Z" fill="#FC790D"/>
                        <mask id="mask0_9754_139" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="64" y="103" width="13" height="14">
                            <path d="M76.1926 110.556C76.4275 106.913 73.9596 103.788 70.6803 103.577C67.401 103.365 64.5522 106.147 64.3173 109.79C64.0823 113.433 66.5502 116.558 69.8295 116.769C73.1088 116.981 75.9576 114.199 76.1926 110.556Z" fill="white"/>
                        </mask>
                        <g mask="url(#mask0_9754_139)">
                            <path d="M80.2319 110.453C80.4255 106.913 77.8644 103.894 74.5115 103.711C71.1586 103.527 68.2836 106.249 68.09 109.789C67.8964 113.33 70.4576 116.348 73.8104 116.532C77.1633 116.715 80.0383 113.994 80.2319 110.453Z" fill="#FDFBF0"/>
                        </g>
                        <path d="M33.241 106.881C33.4493 103.651 31.2636 100.881 28.3591 100.694C25.4546 100.507 22.9311 102.973 22.7228 106.203C22.5146 109.432 24.7003 112.202 27.6048 112.39C30.5093 112.577 33.0327 110.111 33.241 106.881Z" fill="#FC790D"/>
                        <mask id="mask1_9754_139" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="22" y="100" width="12" height="13">
                            <path d="M33.241 106.881C33.4493 103.651 31.2636 100.881 28.3591 100.694C25.4546 100.507 22.9311 102.973 22.7228 106.203C22.5146 109.432 24.7003 112.202 27.6048 112.39C30.5093 112.577 33.0327 110.111 33.241 106.881Z" fill="white"/>
                        </mask>
                        <g mask="url(#mask1_9754_139)">
                            <path d="M36.8156 106.804C36.9872 103.666 34.7167 100.991 31.7443 100.828C28.7719 100.666 26.2232 103.078 26.0517 106.216C25.8801 109.354 28.1506 112.029 31.1229 112.192C34.0953 112.354 36.644 109.942 36.8156 106.804Z" fill="#FDFBF0"/>
                        </g>
                        <path d="M45.7447 39.0499L63.9947 87.2499L57.5847 87.2399L41.3247 39.9399L45.7447 39.0499Z" fill="#673B3C"/>
                        <path d="M54.9047 37.15L62.8347 70.53L50.2847 38.11L54.9047 37.15Z" fill="#673B3C"/>
                        <path d="M136.405 88.86H95.4547C92.5847 88.86 90.3047 86.64 90.4647 83.99L92.8547 44.37C92.9847 42.25 95.6547 41.15 97.4547 42.48L138.425 72.84C139.185 73.4 139.625 74.26 139.625 75.16V85.89C139.625 87.53 138.185 88.86 136.405 88.86Z" fill="#551615"/>
                        <path d="M109.275 122.02L110.815 121.52C110.815 121.52 111.655 107.21 105.505 107.49L109.275 122.02Z" fill="#551615"/>
                        <path d="M94.3347 117.1C94.5647 111.59 97.0547 107.26 99.9147 107.43H104.885C104.985 107.43 105.085 107.43 105.185 107.43C108.035 107.6 110.165 112.2 109.945 117.71C109.715 123.22 107.225 127.55 104.365 127.38L99.3947 126.92C99.2947 126.92 99.1947 126.92 99.0947 126.92C96.2447 126.75 94.1147 122.62 94.3347 117.11V117.1Z" fill="#551615"/>
                        <path d="M107.766 117.836C108.01 114.575 106.901 111.834 105.287 111.713C103.673 111.592 102.167 114.137 101.922 117.398C101.678 120.658 102.788 123.399 104.401 123.52C106.015 123.641 107.521 121.096 107.766 117.836Z" fill="#C22126"/>
                        <path d="M106.995 118C107.265 114.88 106.295 112.19 104.795 111.79C104.985 111.74 105.185 111.72 105.385 111.74C106.995 111.94 108.065 114.74 107.785 118C107.505 121.26 105.975 123.74 104.365 123.54C104.295 123.54 104.235 123.51 104.165 123.49C105.545 123.11 106.755 120.85 107.005 118H106.995Z" fill="#C22126"/>
                        <path d="M126.005 110.99C126.155 107.26 127.845 104.33 129.785 104.44H133.155C133.225 104.44 133.285 104.44 133.355 104.44C135.285 104.55 136.735 107.67 136.575 111.4C136.425 115.13 134.735 118.06 132.795 117.95L129.425 117.64C129.355 117.64 129.295 117.64 129.225 117.64C127.295 117.53 125.845 114.73 126.005 110.99Z" fill="#551615"/>
                        <path d="M135.102 111.495C135.268 109.287 134.518 107.43 133.427 107.348C132.337 107.266 131.319 108.99 131.153 111.199C130.987 113.407 131.737 115.264 132.827 115.346C133.918 115.427 134.936 113.703 135.102 111.495Z" fill="#C22126"/>
                        <path d="M134.585 111.6C134.765 109.49 134.105 107.66 133.095 107.39C133.225 107.35 133.355 107.34 133.495 107.36C134.585 107.49 135.315 109.39 135.115 111.6C134.925 113.81 133.885 115.48 132.795 115.35C132.745 115.35 132.705 115.33 132.655 115.32C133.585 115.06 134.405 113.54 134.575 111.6H134.585Z" fill="#C22126"/>
                        <path d="M92.0847 127.31L98.3447 125.36C99.6547 124.92 100.525 123.74 100.525 122.4V113.06C100.525 110.09 102.575 107.48 105.615 107.48L106.565 106.52H95.7247L92.0847 115.46V127.31Z" fill="white"/>
                        <path d="M124.685 117.21L128.695 115.96C129.535 115.68 130.095 114.92 130.095 114.06V108.07C130.095 106.16 131.505 104.44 133.455 104.44L133.975 103.87H127.015L124.685 109.61V117.21Z" fill="white"/>
                        <path d="M85.6748 95.1899L140.645 93.9099L140.635 99.3199L84.8848 105.58L85.6748 95.1899Z" fill="#FC790D"/>
                        <path d="M35.8647 106.74C35.8647 106.74 41.7547 109.12 60.9547 108.53L35.8647 106.74Z" fill="#551615"/>
                        <path d="M22.5446 115.98L75.8246 120.75C75.8246 120.75 75.5146 123.43 72.7246 123.43C69.9346 123.43 23.7846 118.36 23.7846 118.36C23.7846 118.36 22.2146 117.65 22.5446 115.98Z" fill="#551615"/>
                        <path d="M17.5947 87.36C17.5947 87.36 26.2647 89.45 27.5047 95.11L70.5547 95.71C70.5547 95.71 73.6547 89.15 86.0447 87.36" stroke="#551615" stroke-width="0.61" stroke-miterlimit="10"/>
                        <path d="M98.3346 125.36C99.6846 124.92 100.195 123.95 100.395 123.24L86.8046 127.44C84.6446 128.11 82.4046 128.46 80.1546 128.49C78.7446 129.34 77.3246 129.63 76.2346 129.7C79.7446 130.29 83.3846 129.98 86.8046 128.93L98.2446 125.39C98.2446 125.39 98.3046 125.37 98.3346 125.36Z" fill="#C22126"/>
                        <path d="M130.105 114.05L110.835 120.01C110.835 120.78 110.805 121.47 110.805 121.51L128.505 116.04C130.125 115.49 130.135 114.38 130.105 114.06V114.05Z" fill="#C22126"/>
                        <path d="M137.625 111.72L137.075 111.89C137.115 112.62 137.075 113.31 137.075 113.31C137.075 113.34 137.055 113.36 137.055 113.39L137.615 113.22C140.535 112.36 142.525 109.77 142.525 106.83V105.34C142.525 108.28 140.535 110.87 137.615 111.73L137.625 111.72Z" fill="#C22126"/>
                        <path d="M115.775 50.7H115.545V90.94H115.775V50.7Z" fill="white"/>
                        <path d="M136.445 113.88L137.435 113.56C137.435 113.56 137.745 104.5 133.795 104.68L136.455 113.88H136.445Z" fill="#551615"/>
                        <path d="M142.995 99.0901L142.925 91.2101C141.875 91.1301 140.985 91.9801 140.985 93.0401V101.34C140.985 102.35 141.795 103.18 142.795 103.18H142.855L142.995 99.1001V99.0901Z" fill="#FC790D"/>
                        <path d="M131.445 64.14H131.215V91.7H131.445V64.14Z" fill="white"/>
                    </svg>
                    <span class="font-medium">Buses</span>
                </a>
                <a
                        href="/api/v1/routes"
                        class="flex items-center space-x-3 hover:bg-white hover:bg-opacity-10 rounded-lg p-3 transition"
                >
                    <span class="text-xl">üó∫Ô∏è</span>
                    <span class="font-medium">Routes</span>
                </a>
                <a href="/api/v1/schedule"
                   class="flex items-center space-x-3 hover:bg-white hover:bg-opacity-10  rounded-lg p-3 transition">
                    <span class="text-xl">üìÖ</span>
                    <span class="font-medium">Schedules</span>
                </a>
                <a
                        href="/api/v1/adminbooking"
                        class="flex items-center space-x-3 hover:bg-white hover:bg-opacity-10 rounded-lg p-3 transition"
                >
                    <span class="text-xl">üé´</span>
                    <span class="font-medium">Bookings</span>
                </a>
                <a
                        href="#"
                        class="flex items-center space-x-3 hover:bg-white hover:bg-opacity-10 rounded-lg p-3 transition"
                >
                    <span class="text-xl">üë•</span>
                    <span class="font-medium">Customers</span>
                </a>
            </nav>

            <div class="absolute bottom-6 left-6 right-6">
                <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-4">
                    <div class="flex items-center space-x-3">
                        <div
                                class="w-10 h-10 bg-white rounded-full flex items-center justify-center" id="userLetter"
                        >
                        </div>
                        <div class="flex-1"  id="content">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto">
        <!-- Header -->
        <header class="bg-white border-b border-gray-200 sticky top-0 z-10">
            <div class="px-8 py-4 flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Bus Management</h2>
                    <p class="text-gray-500 text-sm mt-1">
                        Manage your fleet of buses
                    </p>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input
                                type="search"
                                placeholder="Search buses..."
                                class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                        />
                        <span class="absolute left-3 top-2.5 text-gray-400">üîç</span>
                    </div>
                    <button
                            onclick="openCreateBusModal()"
                            class="btn-primary text-white px-6 py-2.5 rounded-lg font-medium shadow-lg flex items-center space-x-2"
                    >
                        <span class="text-xl">+</span>
                        <span>Add Bus</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Stats Cards -->
        <div class="px-8 py-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div
                        class="stat-card rounded-xl p-6 shadow-sm card-hover border border-gray-100"
                >
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Total Buses</p>
                            <p
                                    class="text-3xl font-bold text-gray-800 mt-2"
                                    id="totalBuses"
                            >
                                0
                            </p>
                        </div>
                        <div
                                class="w-12 h-12  flex items-center justify-center"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160" fill="none">
                                <path d="M79.9946 140C113.132 140 139.995 113.137 139.995 80C139.995 46.8629 113.132 20 79.9946 20C46.8575 20 19.9946 46.8629 19.9946 80C19.9946 113.137 46.8575 140 79.9946 140Z" fill="#FFE2CD"/>
                                <path d="M73.9846 129.14C78.1946 130.38 82.7246 130.19 86.9146 128.89L137.735 113.17C140.655 112.31 142.645 109.72 142.645 106.78V74.73C142.645 72.74 141.725 70.85 140.135 69.58L100.465 37.29C94.3346 32.4 77.9646 25.97 77.2946 33.6L65.4446 121.03C65.2046 123.78 68.0646 127.39 73.9746 129.14H73.9846Z" fill="white"/>
                                <path d="M74.9947 129.67L24.6547 124.49C20.1847 124.03 18.1547 120.76 17.5247 114.62V114.67C14.8147 74.25 23.4847 46.81 23.4847 46.81C24.5647 43.26 27.8847 40.73 31.3847 40.13L32.4947 39.95C45.8947 37.25 80.1047 30.13 80.1047 30.13C85.0347 29.28 89.5647 33.01 89.5647 37.93L83.8947 121.8C83.8947 126.5 79.7547 130.17 74.9947 129.68V129.67Z" fill="#C22126"/>
                                <path d="M76.4847 87.28L26.6148 87.19C22.4348 86.76 19.4147 83.05 19.9147 78.94L20.9648 71.22C22.0148 63.46 23.4748 55.75 25.3448 48.13L25.4048 47.87C26.3348 44.59 28.7147 42.4 31.9847 41.83L78.5147 32.25C83.1247 31.45 87.3547 34.94 87.3547 39.54L84.7947 79.9C84.7947 84.29 80.9248 87.72 76.4748 87.26L76.4847 87.28Z" fill="#551615"/>
                                <path d="M76.1926 110.556C76.4275 106.913 73.9596 103.788 70.6803 103.577C67.401 103.365 64.5522 106.147 64.3173 109.79C64.0823 113.433 66.5502 116.558 69.8295 116.769C73.1088 116.981 75.9576 114.199 76.1926 110.556Z" fill="#FC790D"/>
                                <mask id="mask0_9754_139" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="64" y="103" width="13" height="14">
                                    <path d="M76.1926 110.556C76.4275 106.913 73.9596 103.788 70.6803 103.577C67.401 103.365 64.5522 106.147 64.3173 109.79C64.0823 113.433 66.5502 116.558 69.8295 116.769C73.1088 116.981 75.9576 114.199 76.1926 110.556Z" fill="white"/>
                                </mask>
                                <g mask="url(#mask0_9754_139)">
                                    <path d="M80.2319 110.453C80.4255 106.913 77.8644 103.894 74.5115 103.711C71.1586 103.527 68.2836 106.249 68.09 109.789C67.8964 113.33 70.4576 116.348 73.8104 116.532C77.1633 116.715 80.0383 113.994 80.2319 110.453Z" fill="#FDFBF0"/>
                                </g>
                                <path d="M33.241 106.881C33.4493 103.651 31.2636 100.881 28.3591 100.694C25.4546 100.507 22.9311 102.973 22.7228 106.203C22.5146 109.432 24.7003 112.202 27.6048 112.39C30.5093 112.577 33.0327 110.111 33.241 106.881Z" fill="#FC790D"/>
                                <mask id="mask1_9754_139" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="22" y="100" width="12" height="13">
                                    <path d="M33.241 106.881C33.4493 103.651 31.2636 100.881 28.3591 100.694C25.4546 100.507 22.9311 102.973 22.7228 106.203C22.5146 109.432 24.7003 112.202 27.6048 112.39C30.5093 112.577 33.0327 110.111 33.241 106.881Z" fill="white"/>
                                </mask>
                                <g mask="url(#mask1_9754_139)">
                                    <path d="M36.8156 106.804C36.9872 103.666 34.7167 100.991 31.7443 100.828C28.7719 100.666 26.2232 103.078 26.0517 106.216C25.8801 109.354 28.1506 112.029 31.1229 112.192C34.0953 112.354 36.644 109.942 36.8156 106.804Z" fill="#FDFBF0"/>
                                </g>
                                <path d="M45.7447 39.0499L63.9947 87.2499L57.5847 87.2399L41.3247 39.9399L45.7447 39.0499Z" fill="#673B3C"/>
                                <path d="M54.9047 37.15L62.8347 70.53L50.2847 38.11L54.9047 37.15Z" fill="#673B3C"/>
                                <path d="M136.405 88.86H95.4547C92.5847 88.86 90.3047 86.64 90.4647 83.99L92.8547 44.37C92.9847 42.25 95.6547 41.15 97.4547 42.48L138.425 72.84C139.185 73.4 139.625 74.26 139.625 75.16V85.89C139.625 87.53 138.185 88.86 136.405 88.86Z" fill="#551615"/>
                                <path d="M109.275 122.02L110.815 121.52C110.815 121.52 111.655 107.21 105.505 107.49L109.275 122.02Z" fill="#551615"/>
                                <path d="M94.3347 117.1C94.5647 111.59 97.0547 107.26 99.9147 107.43H104.885C104.985 107.43 105.085 107.43 105.185 107.43C108.035 107.6 110.165 112.2 109.945 117.71C109.715 123.22 107.225 127.55 104.365 127.38L99.3947 126.92C99.2947 126.92 99.1947 126.92 99.0947 126.92C96.2447 126.75 94.1147 122.62 94.3347 117.11V117.1Z" fill="#551615"/>
                                <path d="M107.766 117.836C108.01 114.575 106.901 111.834 105.287 111.713C103.673 111.592 102.167 114.137 101.922 117.398C101.678 120.658 102.788 123.399 104.401 123.52C106.015 123.641 107.521 121.096 107.766 117.836Z" fill="#C22126"/>
                                <path d="M106.995 118C107.265 114.88 106.295 112.19 104.795 111.79C104.985 111.74 105.185 111.72 105.385 111.74C106.995 111.94 108.065 114.74 107.785 118C107.505 121.26 105.975 123.74 104.365 123.54C104.295 123.54 104.235 123.51 104.165 123.49C105.545 123.11 106.755 120.85 107.005 118H106.995Z" fill="#C22126"/>
                                <path d="M126.005 110.99C126.155 107.26 127.845 104.33 129.785 104.44H133.155C133.225 104.44 133.285 104.44 133.355 104.44C135.285 104.55 136.735 107.67 136.575 111.4C136.425 115.13 134.735 118.06 132.795 117.95L129.425 117.64C129.355 117.64 129.295 117.64 129.225 117.64C127.295 117.53 125.845 114.73 126.005 110.99Z" fill="#551615"/>
                                <path d="M135.102 111.495C135.268 109.287 134.518 107.43 133.427 107.348C132.337 107.266 131.319 108.99 131.153 111.199C130.987 113.407 131.737 115.264 132.827 115.346C133.918 115.427 134.936 113.703 135.102 111.495Z" fill="#C22126"/>
                                <path d="M134.585 111.6C134.765 109.49 134.105 107.66 133.095 107.39C133.225 107.35 133.355 107.34 133.495 107.36C134.585 107.49 135.315 109.39 135.115 111.6C134.925 113.81 133.885 115.48 132.795 115.35C132.745 115.35 132.705 115.33 132.655 115.32C133.585 115.06 134.405 113.54 134.575 111.6H134.585Z" fill="#C22126"/>
                                <path d="M92.0847 127.31L98.3447 125.36C99.6547 124.92 100.525 123.74 100.525 122.4V113.06C100.525 110.09 102.575 107.48 105.615 107.48L106.565 106.52H95.7247L92.0847 115.46V127.31Z" fill="white"/>
                                <path d="M124.685 117.21L128.695 115.96C129.535 115.68 130.095 114.92 130.095 114.06V108.07C130.095 106.16 131.505 104.44 133.455 104.44L133.975 103.87H127.015L124.685 109.61V117.21Z" fill="white"/>
                                <path d="M85.6748 95.1899L140.645 93.9099L140.635 99.3199L84.8848 105.58L85.6748 95.1899Z" fill="#FC790D"/>
                                <path d="M35.8647 106.74C35.8647 106.74 41.7547 109.12 60.9547 108.53L35.8647 106.74Z" fill="#551615"/>
                                <path d="M22.5446 115.98L75.8246 120.75C75.8246 120.75 75.5146 123.43 72.7246 123.43C69.9346 123.43 23.7846 118.36 23.7846 118.36C23.7846 118.36 22.2146 117.65 22.5446 115.98Z" fill="#551615"/>
                                <path d="M17.5947 87.36C17.5947 87.36 26.2647 89.45 27.5047 95.11L70.5547 95.71C70.5547 95.71 73.6547 89.15 86.0447 87.36" stroke="#551615" stroke-width="0.61" stroke-miterlimit="10"/>
                                <path d="M98.3346 125.36C99.6846 124.92 100.195 123.95 100.395 123.24L86.8046 127.44C84.6446 128.11 82.4046 128.46 80.1546 128.49C78.7446 129.34 77.3246 129.63 76.2346 129.7C79.7446 130.29 83.3846 129.98 86.8046 128.93L98.2446 125.39C98.2446 125.39 98.3046 125.37 98.3346 125.36Z" fill="#C22126"/>
                                <path d="M130.105 114.05L110.835 120.01C110.835 120.78 110.805 121.47 110.805 121.51L128.505 116.04C130.125 115.49 130.135 114.38 130.105 114.06V114.05Z" fill="#C22126"/>
                                <path d="M137.625 111.72L137.075 111.89C137.115 112.62 137.075 113.31 137.075 113.31C137.075 113.34 137.055 113.36 137.055 113.39L137.615 113.22C140.535 112.36 142.525 109.77 142.525 106.83V105.34C142.525 108.28 140.535 110.87 137.615 111.73L137.625 111.72Z" fill="#C22126"/>
                                <path d="M115.775 50.7H115.545V90.94H115.775V50.7Z" fill="white"/>
                                <path d="M136.445 113.88L137.435 113.56C137.435 113.56 137.745 104.5 133.795 104.68L136.455 113.88H136.445Z" fill="#551615"/>
                                <path d="M142.995 99.0901L142.925 91.2101C141.875 91.1301 140.985 91.9801 140.985 93.0401V101.34C140.985 102.35 141.795 103.18 142.795 103.18H142.855L142.995 99.1001V99.0901Z" fill="#FC790D"/>
                                <path d="M131.445 64.14H131.215V91.7H131.445V64.14Z" fill="white"/>
                            </svg>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <!-- <span class="text-green-600 font-semibold">‚Üë 12%</span>
                        <span class="text-gray-500 ml-2">from last month</span> -->
                    </div>
                </div>

                <div
                        class="stat-card rounded-xl p-6 shadow-sm card-hover border border-gray-100"
                >
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Total Seats</p>
                            <p
                                    class="text-3xl font-bold text-gray-800 mt-2"
                                    id="totalSeatsCount"
                            >
                                0
                            </p>
                        </div>
                        <div
                                class="w-12 h-12  flex items-center justify-center"
                        >
                            <svg viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--noto" preserveAspectRatio="xMidYMid meet" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M40.2 98.48c.19.86.11 3.21.11 4.45c0 1.24.1 8.77.1 8.77s-6.67-1.24-8.68-1.24c-2 0-4.85 1.25-5.05 3.62c-.19 2.19 1.14 2.76 2.86 3.24c1.72.48 30.7 6.1 32.13 6.39s4.21-.11 4.58-2.48c.2-1.33-.57-3.37-3.34-4.77c-2.25-1.14-11.44-3.24-11.44-3.24l-.1-13.25l-11.17-1.49z" fill="#858585"></path><path d="M77.4 100.93s-1.14.76-1.14 2.1c0 1.33 1.08 1.48 3.81 2.1c4.2.95 21.64 3.72 23.45 4s4.55.57 4.29-1.91c-.29-2.76-2.19-4.29-7.53-5.72c-4.49-1.2-6.52-1.27-6.96-1.91c-.85-1.24-.14-4.59-.14-4.59l-15.21 2.78l-.57 3.15z" fill="#858585"></path><path d="M27.25 90.25s.67 3.53 3.91 5.63s10.11 4.2 15.92 5.63c5.82 1.43 12.68 2.86 16.4 2.57c3.72-.29 12.11-1.91 24.79-5.82s17.64-6.67 18.21-7.91c.77-1.67.19-5.34.19-5.34l-20.5-6.29l-58.92 11.53z" fill="#9b9b9b"></path><path d="M106.36 78.92s.37 1.79.45 3.07c.07 1.27.11 2.6-.13 3.02s-4.88 2.74-15.12 5.88c-10.24 3.14-25.05 6.8-27.14 6.43c-2.09-.37-.52-9.87-.52-9.87l42.46-8.53z" fill="#172789"></path><path d="M84.83 67.78s-.68-2.05-.15-3.11s2.42-1.21 5.76-1.06c3.33.15 14.19 1.16 15.33 1.27c.92.08 1.78-.84 1.78-.84l-1.43-5.96l-20.69-3.69l-12.56-.17l2.12 17.35l9.84-3.79z" fill="#b0b0b0"></path><path d="M105.74 64.9s.98-2.5-.38-4.09c-1.61-1.87-14.7-1.97-17.04-2.12c-2.35-.15-5.73-.07-5.61-2.42c.13-2.54 2.74-1.82 6.24-1.68c3.57.14 14.27 1.09 16.64 1.91c2.13.74 3 1.74 3.4 2.6c.54 1.16.74 3.24-.27 4.51c-1.36 1.7-2.98 1.29-2.98 1.29z" fill="#858585"></path><path d="M63.77 90.43s6.28-.24 11.37-.95c5.09-.71 22.75-5.47 26.21-6.69c3.46-1.22 5.3-2.34 5.3-2.34s-1.12-6.93-2.14-8.76s-8.39-3.39-13.44-4.07c-4.48-.61-14.16-.31-14.16-.31L44.01 72l-13.92 5.38l27.47 6.64l6.21 6.41z" fill="#024fac"></path><path d="M31.12 77.48s7.2.15 15.61 1.29c8.41 1.14 13.1 2.12 15.98 4.77c1.89 1.74 2.49 4.78 2.8 8.41c.3 3.49 1.2 6.3-3.64 5.45c-3.73-.65-6.97-4.85-7.58-5s-21.67-7.35-21.67-7.35l-1.5-7.57z" fill="#0c66c8"></path><path d="M77.6 65.01s.27 1.65.3 2.34c.01.35-3.16 1-4.52 1.25c-3.55.64-14.01 2.59-16.28 2.97s-25.32 6.02-25.32 6.02l-3.7-1.4l2.12-4.62s24.7-9.14 28.26-9.7c7.74-1.21 19.14 3.14 19.14 3.14z" fill="#172b86"></path><path d="M53.47 67.75s6.5-.77 12-1.41c4.31-.51 12.13-1.28 12.13-1.28s-.61-5.4-1.93-10.13c-1.29-4.63-4.17-8.63-5.17-13.47c-.53-2.57-1.08-5.93-1.08-5.93l-15.19-5.39s-29.52 6.03-29.63 6.68c-.11.65.75 29.85.75 29.85l28.12 1.08z" fill="#024fac"></path><path d="M25.35 38.87s7.11.11 13.47-.65c6.36-.75 11.64-1.51 16.7-1.83c5.06-.32 13.9-.86 13.9-.86s-.22-3.66-.11-4.09s1.66-2.24 2.23-3.24s1.01-2.14 1.19-2.7c.19-.57-2.2-8.74-2.2-8.74L39.61 6.83l-12.82.75l-1.76 24.82l.32 6.47z" fill="#182b85"></path><path d="M27.67 29.33s9.27-1.04 9.59-1.29c.31-.25.29-9.21-.04-11.65c-.54-4.03-1.41-8.73-1.41-9.04s-2.43-1.96-2.43-1.96l-8.23 5.09l2.52 18.85z" fill="#024fac"></path><path d="M65.85 19.37s.58 3.95.54 5.43c-.01.38-.13 1.38.25 1.38s6.1-.69 6.1-.69s1.07-4.78-.38-10.56s-3.96-8.42-3.96-8.42l-9.43.13l6.88 12.73z" fill="#024fac"></path><path d="M61.8 7.58l7.42-.06s-.94-2.07-2.58-2.77c-1.64-.69-9.5-.37-9.5-.37l-23.06.25s-8.17.44-10.87 2.26s-3.27 4.4-3.78 6.62c-.32 1.41-.79 12.57-.65 23.38c.19 15.11 1.75 25.46 1.75 25.46l4.31 5.96l4.86-5.22s.37-7.97-.73-13.93s-2.57-10.24-2.57-10.24s3.22-3.87 3.22-14.77s-.94-14.95-.94-14.95s2.8-.42 5.31-.73c1.55-.19 27.81-.89 27.81-.89z" fill="#0c66c8"></path><path d="M39.86 27.8c.47.47 24.83-2.11 25.29-2.38c.46-.27 1.71-4.22.82-9.44c-1.37-8.06-6.1-12.11-6.1-12.11s-26.38.12-26.65.49c-.27.37 4.09 3.21 5.64 11.45c1.37 7.32.54 11.54 1 11.99z" fill="#e0e0e0"></path><path d="M61.88 97.4s-6.62.41-16.43-1.79c-8.74-1.96-16.79-4.31-18.2-5.36c-1.41-1.05-4.19-10.64-5.44-16.72c-1.19-5.77-1.93-10.87-1.28-11.18c1.12-.54 14.75.92 14.75.92l24.49 7.58l-4.06 4.89l-23.91-.93s.18 4.58 2.75 7.42c1.84 2.04 3.94 2.84 9.99 3.3c6.05.46 12.64 1.01 15.48 4.4c3.14 3.75 1.86 7.47 1.86 7.47z" fill="#b0b0b0"></path><path d="M35.28 63.26c-1.01-.09-2.29.46-2.66 2.38c-.42 2.21 1.83 3.21 5.41 3.39c3.11.16 9.45.79 11.93.93c2.53.15 5.9.78 6.36 2.43c.46 1.65-.61 3.33-.61 3.33s2.13.04 3.09-.27c1.3-.42 2.04-2.11 1.95-3.76s-1.1-3.85-5.41-5.31c-4.3-1.47-20.06-3.12-20.06-3.12z" fill="#858585"></path></g></svg>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <!-- <span class="text-green-600 font-semibold">‚Üë 8%</span>
                        <span class="text-gray-500 ml-2">capacity increase</span> -->
                    </div>
                </div>

                <div
                        class="stat-card rounded-xl p-6 shadow-sm card-hover border border-gray-100"
                >
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">AC Buses</p>
                            <p
                                    class="text-3xl font-bold text-gray-800 mt-2"
                                    id="acBusesCount"
                            >
                                0
                            </p>
                        </div>
                        <div
                                class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center"
                        >
                            <span class="text-3xl">‚ùÑÔ∏è</span>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <!-- <span class="text-blue-600 font-semibold">65%</span>
                        <span class="text-gray-500 ml-2">of total fleet</span> -->
                    </div>
                </div>

                <div
                        class="stat-card rounded-xl p-6 shadow-sm card-hover border border-gray-100"
                >
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Operators</p>
                            <p
                                    class="text-3xl font-bold text-gray-800 mt-2"
                                    id="operatorsCount"
                            >
                                0
                            </p>
                        </div>
                        <div
                                class="w-12 h-1x2 bg-yellow-100 rounded-full flex items-center justify-center"
                        >
                            <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-4.59 -4.59 55.03 55.03" xml:space="preserve" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"><rect x="-4.59" y="-4.59" width="55.03" height="55.03" rx="27.515" fill="#7ed0ec" strokewidth="0"></rect></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M31.751,26.057l-3.572-0.894c1.507-1.339,2.736-3.181,3.559-5.2c1.152-0.255,2.209-1.214,2.383-3.327 c0.164-1.99-0.444-2.877-1.26-3.264c-0.01-0.237-0.021-0.469-0.035-0.696c1.049-5.812-3.103-7.843-3.426-7.941 c-0.541-0.822-4.207-5.821-10.858-1.763c-0.974,0.594-2.519,1.764-3.344,2.942c-0.992,1.246-1.713,3.049-2.009,5.655 c-0.205,0.022-0.409,0.054-0.611,0.1c-0.054-1.279,0.017-5.048,2.405-7.728c1.766-1.981,4.448-2.986,7.968-2.986 c3.526,0,6.263,1.013,8.135,3.009c3.075,3.28,2.797,8.175,2.794,8.224c-0.018,0.262,0.182,0.489,0.443,0.506 c0.012,0.001,0.021,0.001,0.033,0.001c0.248,0,0.457-0.193,0.475-0.445c0.015-0.217,0.312-5.345-3.045-8.933 C29.727,1.116,26.754,0,22.95,0c-3.808,0-6.73,1.114-8.686,3.312c-2.859,3.213-2.706,7.66-2.625,8.695 c-1.113,0.595-1.917,1.89-1.689,4.662c0.301,3.653,2.422,4.926,4.428,4.926c0.39,0,0.734-0.084,1.038-0.239 c1.148,0.743,2.991,1.387,5.944,1.507c0.29,0.436,0.896,0.735,1.6,0.735c0.982,0,1.779-0.586,1.779-1.309 c0-0.723-0.797-1.309-1.779-1.309c-0.801,0-1.478,0.389-1.701,0.924c-1.937-0.092-3.324-0.421-4.315-0.836 c-1.353-1.819-1.996-4.907-1.996-6.671c0-0.653,0.021-1.26,0.059-1.825c6.256,0.21,9.975-2.319,12.007-4.516 c2.617,2.608,3.548,6.138,3.858,7.825c-0.606,4.628-3.906,9.54-7.912,9.54c-1.723,0-3.316-0.909-4.62-2.313 c-1.332-0.278-2.441-0.713-3.323-1.303c0.72,1.287,1.614,2.438,2.645,3.352l-3.58,0.898c-4.889,1.225-8.28,5.598-8.28,10.637v6.033 c0,1.711,1.347,3.129,3.058,3.129h28.09c1.711,0,3.102-1.418,3.102-3.129v-6.033C40.053,31.654,36.64,27.279,31.751,26.057z M30.272,27.652l-4.65,3.183l-1.416-3.622c0.64-0.12,1.259-0.33,1.853-0.617L30.272,27.652z M19.786,26.589 c0.583,0.28,1.194,0.488,1.827,0.61l-1.422,3.637l-4.651-3.184L19.786,26.589z M18.753,43.896h-5.352v-2.533 c0-0.264-0.211-0.477-0.475-0.477c-0.263,0-0.475,0.213-0.475,0.477v2.533h-3.59c-0.66,0-1.159-0.512-1.159-1.172v-6.031 c0-4.088,2.702-7.646,6.624-8.73l5.872,4.025c0.06,0.615,0.572,1.119,1.229,1.137L18.753,43.896z M22.149,28.463l0.446-1.145 c0.121,0.006,0.542,0.008,0.631,0.004l0.445,1.141H22.149z M38.153,42.725c0,0.66-0.543,1.172-1.203,1.172h-3.605v-2.533 c0-0.264-0.211-0.477-0.475-0.477s-0.476,0.213-0.476,0.477v2.533h-5.343l-2.674-10.771c0.652-0.017,1.162-0.515,1.229-1.123 l5.9-4.039c3.922,1.083,6.645,4.642,6.645,8.729v6.031H38.153z"></path> </g> </g></svg>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center text-sm">
                        <!-- <span class="text-purple-600 font-semibold">5</span>
                        <span class="text-gray-500 ml-2">active partners</span> -->
                    </div>
                </div>
            </div>

            <!-- Buses Table -->
            <div
                    class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"
            >
                <div
                        class="px-6 py-4 border-b border-gray-200 flex justify-between items-center"
                >
                    <h3 class="text-lg font-bold text-gray-800">All Buses</h3>
                    <div class="flex space-x-2">
                        <button
                                class="px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition"
                        >
                            Filter
                        </button>
                        <button
                                class="px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition"
                        >
                            Export
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead class="bg-gray-50">
                        <tr>
                            <th
                                    class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider"
                            >
                                Bus Number
                            </th>
                            <th
                                    class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider"
                            >
                                Operator
                            </th>
                            <th
                                    class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider"
                            >
                                Type
                            </th>
                            <th
                                    class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider"
                            >
                                Seats
                            </th>
                            <th
                                    class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider"
                            >
                                Status
                            </th>
                            <th
                                    class="px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider"
                            >
                                Actions
                            </th>
                        </tr>
                        </thead>
                        <tbody id="busesBody" class="bg-white divide-y divide-gray-200">
                        <!-- Filled by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Create Bus Modal -->
<div
        id="createBusModal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"
>
    <div
            class="bg-white rounded-2xl p-8 w-full max-w-lg modal-enter shadow-2xl"
    >
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold text-gray-800">Create New Bus</h3>
            <button
                    onclick="closeModal('createBusModal')"
                    class="text-gray-400 hover:text-gray-600 text-2xl"
            >
                √ó
            </button>
        </div>
        <form id="createBusForm" class="space-y-4">
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2"
                >Bus Number</label
                >
                <input
                        type="text"
                        placeholder="e.g. MH-04-AB-1234"
                        class="w-full p-3 input-modern rounded-lg"
                        id="busNumber"
                        required
                />
            </div>
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2"
                >Operator Name</label
                >
                <input
                        type="text"
                        placeholder="Enter operator name"
                        class="w-full p-3 input-modern rounded-lg"
                        id="operatorName"
                        required
                />
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >Bus Type</label
                    >
                    <select
                            class="w-full p-3 input-modern rounded-lg"
                            id="busType"
                            required
                    >
                        <option value="">Select Type</option>
                        <option value="Volvo">Volvo</option>
                        <option value="Sleeper">Sleeper</option>
                        <option value="Semi-Sleeper">Semi-Sleeper</option>
                        <option value="AC">AC</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >Seat Type</label
                    >
                    <select
                            class="w-full p-3 input-modern rounded-lg"
                            id="seatType"
                            required
                    >
                        <option value="SEATER">Seater</option>
                        <option value="SLEEPER">Sleeper</option>
                        <option value="SEMI_SLEEPER">Semi-Sleeper</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >AC Type</label
                    >
                    <select
                            class="w-full p-3 input-modern rounded-lg"
                            id="acType"
                            required
                    >
                        <option value="AC">AC</option>
                        <option value="NON_AC">Non-AC</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >Total Seats</label
                    >
                    <input
                            type="number"
                            placeholder="40"
                            class="w-full p-3 input-modern rounded-lg"
                            id="totalSeats"
                            min="1"
                            required
                    />
                </div>
            </div>
            <div class="flex space-x-3 mt-6">
                <button
                        type="submit"
                        class="flex-1 btn-primary text-white px-6 py-3 rounded-lg font-semibold"
                >
                    Create Bus
                </button>
                <button
                        type="button"
                        onclick="closeModal('createBusModal')"
                        class="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-semibold transition"
                >
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Edit Bus Modal -->
<div
        id="editBusModal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"
>
    <div
            class="bg-white rounded-2xl p-8 w-full max-w-lg modal-enter shadow-2xl"
    >
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold text-gray-800">Edit Bus</h3>
            <button
                    onclick="closeModal('editBusModal')"
                    class="text-gray-400 hover:text-gray-600 text-2xl"
            >
                √ó
            </button>
        </div>
        <form id="editBusForm" class="space-y-4">
            <input type="hidden" id="editBusId" />
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2"
                >Bus Number</label
                >
                <input
                        type="text"
                        class="w-full p-3 input-modern rounded-lg"
                        id="editBusNumber"
                        required
                />
            </div>
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2"
                >Operator Name</label
                >
                <input
                        type="text"
                        class="w-full p-3 input-modern rounded-lg"
                        id="editOperatorName"
                        required
                />
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >Bus Type</label
                    >
                    <select
                            class="w-full p-3 input-modern rounded-lg"
                            id="editBusType"
                            required
                    >
                        <option value="Volvo">Volvo</option>
                        <option value="Sleeper">Sleeper</option>
                        <option value="Semi-Sleeper">Semi-Sleeper</option>
                        <option value="AC">AC</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >Seat Type</label
                    >
                    <select
                            class="w-full p-3 input-modern rounded-lg"
                            id="editSeatType"
                            required
                    >
                        <option value="SEATER">Seater</option>
                        <option value="SLEEPER">Sleeper</option>
                        <option value="SEMI_SLEEPER">Semi-Sleeper</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >AC Type</label
                    >
                    <select
                            class="w-full p-3 input-modern rounded-lg"
                            id="editAcType"
                            required
                    >
                        <option value="AC">AC</option>
                        <option value="NON_AC">Non-AC</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2"
                    >Total Seats</label
                    >
                    <input
                            type="number"
                            class="w-full p-3 input-modern rounded-lg"
                            id="editTotalSeats"
                            min="1"
                            required
                    />
                </div>
            </div>
            <div class="flex space-x-3 mt-6">
                <button
                        type="submit"
                        class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition"
                >
                    Update Bus
                </button>
                <button
                        type="button"
                        onclick="closeModal('editBusModal')"
                        class="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-semibold transition"
                >
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Seats Modal -->
<div
        id="seatsModal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"
>
    <div
            class="bg-white rounded-2xl p-8 w-full max-w-4xl max-h-screen overflow-y-auto modal-enter shadow-2xl"
    >
        <div class="flex justify-between items-center mb-6">
            <div>
                <h3 class="text-2xl font-bold text-gray-800">Manage Seats</h3>
                <div class="mt-4">
                    <h4 class="text-xl font-semibold mb-3">Seat Layout</h4>
                    <div id="seatLayout" class="grid grid-cols-6 gap-3"></div>
                </div>
                <p class="text-gray-500 text-sm mt-1">
                    Bus: <span id="modalBusNumber" class="font-semibold"></span>
                </p>
            </div>
            <button
                    onclick="closeModal('seatsModal')"
                    class="text-gray-400 hover:text-gray-600 text-3xl"
            >
                √ó
            </button>
        </div>
        <button
                onclick="addSeatRow()"
                class="mb-4 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition shadow-sm"
        >
            + Add Seat
        </button>
        <div class="overflow-x-auto">
            <table
                    class="min-w-full border border-gray-200 rounded-lg overflow-hidden"
            >
                <thead class="bg-gray-50">
                <tr>
                    <th class="p-4 text-left text-sm font-bold text-gray-700">
                        Seat Number
                    </th>
                    <th class="p-4 text-left text-sm font-bold text-gray-700">
                        Type
                    </th>
                    <th class="p-4 text-left text-sm font-bold text-gray-700">
                        Deck
                    </th>
                    <th class="p-4 text-center text-sm font-bold text-gray-700">
                        Action
                    </th>
                </tr>
                </thead>
                <tbody id="seatsTableBody" class="divide-y divide-gray-200"></tbody>
            </table>
        </div>
        <div class="mt-6 flex justify-end space-x-3">
            <button
                    onclick="closeModal('seatsModal')"
                    class="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-semibold transition"
            >
                Cancel
            </button>
            <button
                    onclick="saveAllSeats()"
                    class="btn-primary text-white px-8 py-3 rounded-lg font-semibold shadow-lg"
            >
                Save All Seats
            </button>
        </div>
    </div>
</div>

<script>
    const jwt = localStorage.getItem("jwt");
    const username = localStorage.getItem("username") || "User";

  const content = document.getElementById("content");
  const fisrtLetter = document.getElementById("userLetter");

  if (jwt) {
      fisrtLetter.innerHTML = `
          <span class="text-purple-600 font-bold">${username.charAt(0).toUpperCase()}</span>
          `

      content.innerHTML = `
      <p class="font-semibold text-sm" >Admin User</p>
      <p class="font-medium text-sm">${username}</p>
      `
  }

  function getAuthHeaders() {
    return {
      "Content-Type": "application/json",
      Authorization: "Bearer " + localStorage.getItem("jwt"),
    };
  }

  let currentBusId = null;
  let buses = [];

  // Load Buses
  async function loadBuses() {
    try {
      console.log("TOKEN USED IN FETCH:", localStorage.getItem("token"));
      const res = await fetch("/api/v1/admin/buses/all", {
        headers: getAuthHeaders(),
      });

      const page = await res.json();
      // console.log("API response:", page);
      buses = page.content || page.data || page || [];
      const tbody = document.getElementById("busesBody");
      tbody.innerHTML = "";

      if (!Array.isArray(buses)) {
        buses = [];
      }

      console.log(buses);

      buses.forEach((bus) => {
        const tr = document.createElement("tr");
        tr.className = "table-row";
        tr.innerHTML = `
          <td class="px-6 py-4">
              <div class="flex items-center">
                  <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                      <svg xmlns="http://www.w3.org/2000/svg" width="160" height="30" viewBox="0 0 160 160" fill="none">
                                <path d="M79.9946 140C113.132 140 139.995 113.137 139.995 80C139.995 46.8629 113.132 20 79.9946 20C46.8575 20 19.9946 46.8629 19.9946 80C19.9946 113.137 46.8575 140 79.9946 140Z" fill="#FFE2CD"/>
                                <path d="M73.9846 129.14C78.1946 130.38 82.7246 130.19 86.9146 128.89L137.735 113.17C140.655 112.31 142.645 109.72 142.645 106.78V74.73C142.645 72.74 141.725 70.85 140.135 69.58L100.465 37.29C94.3346 32.4 77.9646 25.97 77.2946 33.6L65.4446 121.03C65.2046 123.78 68.0646 127.39 73.9746 129.14H73.9846Z" fill="white"/>
                                <path d="M74.9947 129.67L24.6547 124.49C20.1847 124.03 18.1547 120.76 17.5247 114.62V114.67C14.8147 74.25 23.4847 46.81 23.4847 46.81C24.5647 43.26 27.8847 40.73 31.3847 40.13L32.4947 39.95C45.8947 37.25 80.1047 30.13 80.1047 30.13C85.0347 29.28 89.5647 33.01 89.5647 37.93L83.8947 121.8C83.8947 126.5 79.7547 130.17 74.9947 129.68V129.67Z" fill="#C22126"/>
                                <path d="M76.4847 87.28L26.6148 87.19C22.4348 86.76 19.4147 83.05 19.9147 78.94L20.9648 71.22C22.0148 63.46 23.4748 55.75 25.3448 48.13L25.4048 47.87C26.3348 44.59 28.7147 42.4 31.9847 41.83L78.5147 32.25C83.1247 31.45 87.3547 34.94 87.3547 39.54L84.7947 79.9C84.7947 84.29 80.9248 87.72 76.4748 87.26L76.4847 87.28Z" fill="#551615"/>
                                <path d="M76.1926 110.556C76.4275 106.913 73.9596 103.788 70.6803 103.577C67.401 103.365 64.5522 106.147 64.3173 109.79C64.0823 113.433 66.5502 116.558 69.8295 116.769C73.1088 116.981 75.9576 114.199 76.1926 110.556Z" fill="#FC790D"/>
                                <mask id="mask0_9754_139" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="64" y="103" width="13" height="14">
                                    <path d="M76.1926 110.556C76.4275 106.913 73.9596 103.788 70.6803 103.577C67.401 103.365 64.5522 106.147 64.3173 109.79C64.0823 113.433 66.5502 116.558 69.8295 116.769C73.1088 116.981 75.9576 114.199 76.1926 110.556Z" fill="white"/>
                                </mask>
                                <g mask="url(#mask0_9754_139)">
                                    <path d="M80.2319 110.453C80.4255 106.913 77.8644 103.894 74.5115 103.711C71.1586 103.527 68.2836 106.249 68.09 109.789C67.8964 113.33 70.4576 116.348 73.8104 116.532C77.1633 116.715 80.0383 113.994 80.2319 110.453Z" fill="#FDFBF0"/>
                                </g>
                                <path d="M33.241 106.881C33.4493 103.651 31.2636 100.881 28.3591 100.694C25.4546 100.507 22.9311 102.973 22.7228 106.203C22.5146 109.432 24.7003 112.202 27.6048 112.39C30.5093 112.577 33.0327 110.111 33.241 106.881Z" fill="#FC790D"/>
                                <mask id="mask1_9754_139" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="22" y="100" width="12" height="13">
                                    <path d="M33.241 106.881C33.4493 103.651 31.2636 100.881 28.3591 100.694C25.4546 100.507 22.9311 102.973 22.7228 106.203C22.5146 109.432 24.7003 112.202 27.6048 112.39C30.5093 112.577 33.0327 110.111 33.241 106.881Z" fill="white"/>
                                </mask>
                                <g mask="url(#mask1_9754_139)">
                                    <path d="M36.8156 106.804C36.9872 103.666 34.7167 100.991 31.7443 100.828C28.7719 100.666 26.2232 103.078 26.0517 106.216C25.8801 109.354 28.1506 112.029 31.1229 112.192C34.0953 112.354 36.644 109.942 36.8156 106.804Z" fill="#FDFBF0"/>
                                </g>
                                <path d="M45.7447 39.0499L63.9947 87.2499L57.5847 87.2399L41.3247 39.9399L45.7447 39.0499Z" fill="#673B3C"/>
                                <path d="M54.9047 37.15L62.8347 70.53L50.2847 38.11L54.9047 37.15Z" fill="#673B3C"/>
                                <path d="M136.405 88.86H95.4547C92.5847 88.86 90.3047 86.64 90.4647 83.99L92.8547 44.37C92.9847 42.25 95.6547 41.15 97.4547 42.48L138.425 72.84C139.185 73.4 139.625 74.26 139.625 75.16V85.89C139.625 87.53 138.185 88.86 136.405 88.86Z" fill="#551615"/>
                                <path d="M109.275 122.02L110.815 121.52C110.815 121.52 111.655 107.21 105.505 107.49L109.275 122.02Z" fill="#551615"/>
                                <path d="M94.3347 117.1C94.5647 111.59 97.0547 107.26 99.9147 107.43H104.885C104.985 107.43 105.085 107.43 105.185 107.43C108.035 107.6 110.165 112.2 109.945 117.71C109.715 123.22 107.225 127.55 104.365 127.38L99.3947 126.92C99.2947 126.92 99.1947 126.92 99.0947 126.92C96.2447 126.75 94.1147 122.62 94.3347 117.11V117.1Z" fill="#551615"/>
                                <path d="M107.766 117.836C108.01 114.575 106.901 111.834 105.287 111.713C103.673 111.592 102.167 114.137 101.922 117.398C101.678 120.658 102.788 123.399 104.401 123.52C106.015 123.641 107.521 121.096 107.766 117.836Z" fill="#C22126"/>
                                <path d="M106.995 118C107.265 114.88 106.295 112.19 104.795 111.79C104.985 111.74 105.185 111.72 105.385 111.74C106.995 111.94 108.065 114.74 107.785 118C107.505 121.26 105.975 123.74 104.365 123.54C104.295 123.54 104.235 123.51 104.165 123.49C105.545 123.11 106.755 120.85 107.005 118H106.995Z" fill="#C22126"/>
                                <path d="M126.005 110.99C126.155 107.26 127.845 104.33 129.785 104.44H133.155C133.225 104.44 133.285 104.44 133.355 104.44C135.285 104.55 136.735 107.67 136.575 111.4C136.425 115.13 134.735 118.06 132.795 117.95L129.425 117.64C129.355 117.64 129.295 117.64 129.225 117.64C127.295 117.53 125.845 114.73 126.005 110.99Z" fill="#551615"/>
                                <path d="M135.102 111.495C135.268 109.287 134.518 107.43 133.427 107.348C132.337 107.266 131.319 108.99 131.153 111.199C130.987 113.407 131.737 115.264 132.827 115.346C133.918 115.427 134.936 113.703 135.102 111.495Z" fill="#C22126"/>
                                <path d="M134.585 111.6C134.765 109.49 134.105 107.66 133.095 107.39C133.225 107.35 133.355 107.34 133.495 107.36C134.585 107.49 135.315 109.39 135.115 111.6C134.925 113.81 133.885 115.48 132.795 115.35C132.745 115.35 132.705 115.33 132.655 115.32C133.585 115.06 134.405 113.54 134.575 111.6H134.585Z" fill="#C22126"/>
                                <path d="M92.0847 127.31L98.3447 125.36C99.6547 124.92 100.525 123.74 100.525 122.4V113.06C100.525 110.09 102.575 107.48 105.615 107.48L106.565 106.52H95.7247L92.0847 115.46V127.31Z" fill="white"/>
                                <path d="M124.685 117.21L128.695 115.96C129.535 115.68 130.095 114.92 130.095 114.06V108.07C130.095 106.16 131.505 104.44 133.455 104.44L133.975 103.87H127.015L124.685 109.61V117.21Z" fill="white"/>
                                <path d="M85.6748 95.1899L140.645 93.9099L140.635 99.3199L84.8848 105.58L85.6748 95.1899Z" fill="#FC790D"/>
                                <path d="M35.8647 106.74C35.8647 106.74 41.7547 109.12 60.9547 108.53L35.8647 106.74Z" fill="#551615"/>
                                <path d="M22.5446 115.98L75.8246 120.75C75.8246 120.75 75.5146 123.43 72.7246 123.43C69.9346 123.43 23.7846 118.36 23.7846 118.36C23.7846 118.36 22.2146 117.65 22.5446 115.98Z" fill="#551615"/>
                                <path d="M17.5947 87.36C17.5947 87.36 26.2647 89.45 27.5047 95.11L70.5547 95.71C70.5547 95.71 73.6547 89.15 86.0447 87.36" stroke="#551615" stroke-width="0.61" stroke-miterlimit="10"/>
                                <path d="M98.3346 125.36C99.6846 124.92 100.195 123.95 100.395 123.24L86.8046 127.44C84.6446 128.11 82.4046 128.46 80.1546 128.49C78.7446 129.34 77.3246 129.63 76.2346 129.7C79.7446 130.29 83.3846 129.98 86.8046 128.93L98.2446 125.39C98.2446 125.39 98.3046 125.37 98.3346 125.36Z" fill="#C22126"/>
                                <path d="M130.105 114.05L110.835 120.01C110.835 120.78 110.805 121.47 110.805 121.51L128.505 116.04C130.125 115.49 130.135 114.38 130.105 114.06V114.05Z" fill="#C22126"/>
                                <path d="M137.625 111.72L137.075 111.89C137.115 112.62 137.075 113.31 137.075 113.31C137.075 113.34 137.055 113.36 137.055 113.39L137.615 113.22C140.535 112.36 142.525 109.77 142.525 106.83V105.34C142.525 108.28 140.535 110.87 137.615 111.73L137.625 111.72Z" fill="#C22126"/>
                                <path d="M115.775 50.7H115.545V90.94H115.775V50.7Z" fill="white"/>
                                <path d="M136.445 113.88L137.435 113.56C137.435 113.56 137.745 104.5 133.795 104.68L136.455 113.88H136.445Z" fill="#551615"/>
                                <path d="M142.995 99.0901L142.925 91.2101C141.875 91.1301 140.985 91.9801 140.985 93.0401V101.34C140.985 102.35 141.795 103.18 142.795 103.18H142.855L142.995 99.1001V99.0901Z" fill="#FC790D"/>
                                <path d="M131.445 64.14H131.215V91.7H131.445V64.14Z" fill="white"/>
                            </svg>
                  </div>
                  <span class="font-semibold text-gray-800">${
                    bus.busNumber
                  }</span>
              </div>
          </td>
          <td class="px-6 py-4 text-gray-700">${
            bus.operatorName || "N/A"
          }</td>
          <td class="px-6 py-4">
              <span class="badge bg-purple-100 text-purple-700">${
                bus.busType || "Standard"
              }</span>
          </td>
          <td class="px-6 py-4">
              <span class="font-semibold text-gray-800">${
                bus.totalSeats
              }</span>
              <span class="text-gray-500 text-sm ml-1">seats</span>
          </td>
          <td class="px-6 py-4">
              <span class="badge ${
                bus.acType === "AC"
                  ? "bg-blue-100 text-blue-700"
                  : "bg-gray-100 text-gray-700"
              }">${bus.acType || "N/A"}</span>
          </td>
          <td class="px-6 py-4">
              <div class="flex justify-center space-x-2">
                  <button onclick="openSeatsModal(${bus.busId}, '${
          bus.busNumber
        }')" class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition shadow-sm">Seats</button>
                  <button onclick="editBus(${
                    bus.busId
                  })" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition shadow-sm">Edit</button>
                  <button onclick="deleteBus(${
                    bus.busId
                  })" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition shadow-sm">Delete</button>
              </div>
          </td>
      `;
        tbody.appendChild(tr);
      });

      updateStats();
    } catch (error) {
      console.error("Error loading buses:", error);
    }
  }

  // Update Statistics
  function updateStats() {
    document.getElementById("totalBuses").textContent = buses.length;
    const totalSeats = buses.reduce(
      (sum, bus) => sum + (bus.totalSeats || 0),
      0
    );
    document.getElementById("totalSeatsCount").textContent = totalSeats;
    const acBuses = buses.filter((bus) => bus.acType === "AC").length;
    document.getElementById("acBusesCount").textContent = acBuses;
    const operators = new Set(buses.map((bus) => bus.operatorName)).size;
    document.getElementById("operatorsCount").textContent = operators;
  }

  // Modal Functions
  function openCreateBusModal() {
    document.getElementById("createBusModal").classList.remove("hidden");
  }

  function closeModal(modalId) {
    document.getElementById(modalId).classList.add("hidden");
  }

  // Create Bus
  document.getElementById("createBusForm").onsubmit = async (e) => {
    e.preventDefault();
    const data = {
      busNumber: document.getElementById("busNumber").value,
      operatorName: document.getElementById("operatorName").value,
      busType: document.getElementById("busType").value,
      seatType: document.getElementById("seatType").value,
      acType: document.getElementById("acType").value,
      totalSeats: parseInt(document.getElementById("totalSeats").value),
    };

    try {
      const res = await fetch("/api/v1/admin/buses", {
        method: "POST",
        headers: getAuthHeaders(),
        body: JSON.stringify(data),
      });
      if (!res.ok) throw new Error("Failed to create bus");
      closeModal("createBusModal");
      document.getElementById("createBusForm").reset();
      loadBuses();
      Swal.fire({
        icon: "success",
        title: "Success!",
        text: "Bus created successfully",
        showConfirmButton: false,
        timer: 1500,
      });
    } catch (error) {
      Swal.fire("Error", "Failed to create bus", "error");
    }
  };

  // Edit Bus
  async function editBus(busId) {
    const bus = buses.find((b) => b.busId === busId);
    if (!bus) return;

    document.getElementById("editBusId").value = bus.busId;
    document.getElementById("editBusNumber").value = bus.busNumber;
    document.getElementById("editOperatorName").value = bus.operatorName;
    document.getElementById("editBusType").value = bus.busType;
    document.getElementById("editSeatType").value = bus.seatType;
    document.getElementById("editAcType").value = bus.acType;
    document.getElementById("editTotalSeats").value = bus.totalSeats;

    document.getElementById("editBusModal").classList.remove("hidden");
  }

  document.getElementById("editBusForm").onsubmit = async (e) => {
    e.preventDefault();
    const busId = document.getElementById("editBusId").value;
    const data = {
      busNumber: document.getElementById("editBusNumber").value,
      operatorName: document.getElementById("editOperatorName").value,
      busType: document.getElementById("editBusType").value,
      seatType: document.getElementById("editSeatType").value,
      acType: document.getElementById("editAcType").value,
      totalSeats: parseInt(document.getElementById("editTotalSeats").value),
    };

    try {
      const res = await fetch(`/api/v1/admin/buses/${busId}`, {
        method: "PUT",
        headers: getAuthHeaders(),
        body: JSON.stringify(data),
      });
      closeModal("editBusModal");
      loadBuses();

      if (!res.ok) throw new Error("Seat Update failed");
      Swal.fire({
        icon: "success",
        title: "Updated!",
        text: "Bus updated successfully",
        showConfirmButton: false,
        timer: 1500,
      });
    } catch (error) {
      Swal.fire("Error", "Failed to update bus", "error");
    }
  };

  // Delete Bus
  async function deleteBus(busId) {
    const result = await Swal.fire({
      title: "Are you sure?",
      text: "You won't be able to revert this!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#dc2626",
      cancelButtonColor: "#6b7280",
      confirmButtonText: "Yes, delete it!",
    });

    if (result.isConfirmed) {
      try {
        const res = await fetch(`/api/v1/admin/buses/${busId}`, {
          method: "DELETE",
          headers: getAuthHeaders(),
        });
        loadBuses();
        if (!res.ok) throw new Error("Bus Delete Failed");
        Swal.fire({
          icon: "success",
          title: "Deleted!",
          text: "Bus has been deleted.",
          showConfirmButton: false,
          timer: 1500,
        });
      } catch (error) {
        Swal.fire("Error", "Failed to delete bus", "error");
      }
    }
  }

  // Seats Management
  async function openSeatsModal(busId, busNumber) {
    currentBusId = busId;
    document.getElementById("modalBusNumber").textContent = busNumber;
    document.getElementById("seatsModal").classList.remove("hidden");

    try {
      const res = await fetch(`/api/v1/admin/buses/${busId}`, {
        headers: getAuthHeaders(),
      });
      const bus = await res.json();
      let seats = bus.seats || [];

      if (!Array.isArray(seats)) {
        seats = seats.data || seats.content || [];
      }
      console.log("Loaded seats from bus object:", seats);
      renderSeats(seats);
    } catch (error) {
      console.error("Error loading seats:", error);
      renderSeats([]);
    }
  }

  function renderSeats(seats) {
    // console.log("Rendering seats‚Ä¶", seats);
    const tbody = document.getElementById("seatsTableBody");
    const layout = document.getElementById("seatLayout");

    tbody.innerHTML = "";
    layout.innerHTML = "";

    seats.forEach((seat) => {
      // === TABLE ROWS (unchanged) ===
      const tr = document.createElement("tr");
      tr.className = "hover:bg-gray-50";
      tr.innerHTML = `
<td class="p-4">
<input type="text" value="${seat.seatNumber}"
class="w-full p-2 border border-gray-300 rounded-lg input-modern"
data-seat-id="${seat.seatId}" data-field="seatNumber">
</td>
<td class="p-4">
<select class="w-full p-2 border border-gray-300 rounded-lg input-modern"
data-seat-id="${seat.seatId}" data-field="seatType">
    <option value="WINDOW" ${
      seat.seatType === "WINDOW" ? "selected" : ""
    }>WINDOW</option>
    <option value="AISLE" ${
      seat.seatType === "AISLE" ? "selected" : ""
    }>AISLE</option>
</select>
</td>
<td class="p-4">
<select class="w-full p-2 border border-gray-300 rounded-lg input-modern"
data-seat-id="${seat.seatId}" data-field="deckType">
    <option value="LOWER" ${
      seat.deckType === "LOWER" ? "selected" : ""
    }>Lower</option>
    <option value="UPPER" ${
      seat.deckType === "UPPER" ? "selected" : ""
    }>Upper</option>
</select>
</td>
<td class="p-4 text-center">
<button onclick="deleteSeat(${seat.seatId})"
class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-lg text-sm font-medium">Delete</button>
</td>
`;
      tbody.appendChild(tr);

      //  VISUAL LAYOUT
      const seatDiv = document.createElement("div");
      seatDiv.className = `
flex items-center justify-center font-semibold cursor-pointer
<!--${seat.deckType === "UPPER" ? "bg-blue-200" : "bg-green-200"}-->
`;

      seatDiv.innerHTML = `
<div class="flex flex-col items-center">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="26"
    height="27"
    viewBox="0 0 26 27"
    fill="none"
  >

    <rect id="bgRect" width="26" height="27" fill="#FFFFFF"></rect>
    <g clip-path="url(#clip0_53838_44859)">
      <path
        d="M2.84407 9.51883V4.40009C2.84407 2.61259 4.30657 1.15009 6.09407 1.15009H19.9066C21.6941 1.15009 23.1566 2.61259 23.1566 4.40009V9.51883M22.9941 9.51883H22.2628C21.6128 9.51883 21.1253 10.0876 21.1253 10.6563V17.7251C21.1253 19.6751 19.5816 21.2188 17.6316 21.2188H8.45032C6.50032 21.2188 4.95657 19.6751 4.95657 17.7251V10.6563C4.95657 10.0063 4.46907 9.51883 3.81907 9.51883H3.00657C1.70657 9.51883 0.731567 10.5751 0.731567 11.7938V22.5188C0.731567 24.3063 2.19407 25.7688 3.98157 25.7688H22.1003C23.8878 25.7688 25.3503 24.3063 25.3503 22.5188V11.8751C25.3503 10.5751 24.2941 9.51883 22.9941 9.51883Z"
        stroke="#007B28"
        stroke-width="1.5"
        stroke-miterlimit="10"
      />
    </g>
    <defs>
      <clipPath id="clip0_53838_44859">
        <rect
          width="26"
          height="26"
          fill="white"
          transform="translate(0 0.5)"
        />
      </clipPath>
    </defs>
    <div xmlns="" id="divScriptsUsed" style="display: none" />
    <script
      xmlns=""
      id="globalVarsDetection"
      src="chrome-extension://cmkdbmfndkfgebldhnkbfhlneefdaaip/js/wrs_env.js"
    />
  </svg>
<span class="mt-1">${seat.seatNumber}</span>
</div>
`;

      seatDiv.onclick = () => {
        const bgRect = seatDiv.querySelector("#bgRect");

        if (bgRect.getAttribute("fill") === "#7eca7e") {
          bgRect.setAttribute("fill", "#FFFFFF");
        } else {
          bgRect.setAttribute("fill", "#7eca7e");
        }
      };

      layout.appendChild(seatDiv);
    });
  }

  function addSeatRow() {
    const tbody = document.getElementById("seatsTableBody");
    const tr = document.createElement("tr");
    tr.className = "hover:bg-gray-50 bg-green-50";
    tr.innerHTML = `
  <td class="p-4">
      <input type="text" placeholder="e.g. A1" class="w-full p-2 border border-gray-300 rounded-lg input-modern" data-field="seatNumber">
  </td>
  <td class="p-4">
      <select class="w-full p-2 border border-gray-300 rounded-lg input-modern" data-field="seatType">
          <option value="WINDOW">WINDOW</option>
          <option value="AISLE">AISLE</option>
      </select>
  </td>
  <td class="p-4">
      <select class="w-full p-2 border border-gray-300 rounded-lg input-modern" data-field="deckType">
          <option value="LOWER">Lower</option>
          <option value="UPPER">Upper</option>
      </select>
  </td>
  <td class="p-4 text-center">
      <button onclick="this.closest('tr').remove()" class="bg-gray-400 hover:bg-gray-500 text-white px-3 py-1 rounded-lg text-sm font-medium transition">Remove</button>
  </td>
`;
    tbody.appendChild(tr);
  }

  async function deleteSeat(seatId) {
    const result = await Swal.fire({
      title: "Delete seat?",
      text: "This action cannot be undone",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#dc2626",
      cancelButtonColor: "#6b7280",
      confirmButtonText: "Yes, delete it!",
    });

    if (result.isConfirmed) {
      try {
        const res = await fetch(
          `/api/v1/admin/buses/${currentBusId}/seats/${seatId}`,
          {
            method: "DELETE",
            headers: getAuthHeaders(),
          }
        );
        openSeatsModal(
          currentBusId,
          document.getElementById("modalBusNumber").textContent
        );

        if (!res.ok) throw new Error("Seat Delete failed");

        Swal.fire({
          icon: "success",
          title: "Deleted!",
          text: "Seat has been deleted.",
          showConfirmButton: false,
          timer: 1500,
        });
      } catch (error) {
        Swal.fire("Error", "Failed to delete seat", "error");
      }
    }
  }

  async function saveAllSeats() {
    const rows = document.querySelectorAll("#seatsTableBody tr");
    const updates = [];
    const creates = [];

    rows.forEach((row) => {
      const seatNumber = row.querySelector(
        '[data-field="seatNumber"]'
      ).value;
      const seatType = row.querySelector('[data-field="seatType"]').value;
      const deckType = row.querySelector('[data-field="deckType"]').value;
      const seatId = row.querySelector("[data-seat-id]")?.dataset.seatId;

      const seatData = { seatNumber, seatType, deckType };

      if (seatId) {
        updates.push(
          fetch(`/api/v1/admin/buses/${currentBusId}/seats/${seatId}`, {
            method: "PUT",
            headers: getAuthHeaders(),
            body: JSON.stringify(seatData),
          })
        );
      } else {
        creates.push(
          fetch(`/api/v1/admin/buses/${currentBusId}/seats`, {
            method: "POST",
            headers: getAuthHeaders(),
            body: JSON.stringify([seatData]),
          })
        );
      }
    });

    try {
      const results = await Promise.all([...updates, ...creates]);

      results.forEach((res) => {
        if (!res.ok) throw new Error("Seat save failed");
      });

      closeModal("seatsModal");

      Swal.fire({
        icon: "success",
        title: "Success!",
        text: "All seats saved successfully",
        showConfirmButton: false,
        timer: 1500,
      });
    } catch (error) {
      Swal.fire("Error", "Failed to save seats", "error");
    }
  }
  // Initialize
  loadBuses();
</script>
</body>
</html>
